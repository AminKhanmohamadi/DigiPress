{% extends '_base.html' %}
{% load humanize %}
{% load i18n %}
{% load static %}


{% block main_content %}
    <div class="wrapper shopping-page">

        <!--------------------------- Main Content Section-->
        <main class="main-content dt-sl mt-4 mb-3">
            <div class="container main-container">
                <div class="row" style="margin-top: 50px;">
                    <div class="cart-page-content col-xl-9 col-lg-8 col-12 px-0">
                        <div class="section-title text-sm-title title-wide no-after-title-wide mb-0 px-res-1">
                            <h2>انتخاب آدرس تحویل سفارش</h2>
                        </div>
                        <section class="page-content dt-sl">
                            <div class="address-section">
                                <div class="checkout-contact dt-sn dt-sn--box border px-0 pt-0 pb-0">

                                    <div class="checkout-contact-content">
                                        {% if user.first_name %}
                                            <ul class="checkout-contact-items">
                                                <li class="checkout-contact-item">
                                                    گیرنده:
                                                    <span class="full-name">{{ user.get_full_name }}</span>

                                                </li>
                                                <li class="checkout-contact-item">
                                                    <div class="checkout-contact-item checkout-contact-item-mobile">
                                                        شماره تماس:
                                                        <span class="mobile-phone">{{ user.phone_number }}</span>
                                                    </div>
                                                    <div class="checkout-contact-item-message">
                                                        کد پستی:
                                                        <span class="post-code">{{ user.postal_code }}</span>
                                                    </div>
                                                    <br>
                                                    <span class="address-part">{{ user.address }}</span>
                                                </li>
                                            </ul>
                                            <a class="checkout-contact-location" id="btn-checkout-contact-location">تغییر
                                                آدرس
                                                ارسال</a>
                                            {% else %}
                                            <a class="checkout-contact-location" style="position: unset;" id="btn-checkout-contact-location">وارد کردن
                                            آدرس
                                            ارسال</a>
                                        {% endif %}

                                        <div class="checkout-contact-badge">
                                            <i>
                                                <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none"
                                                     xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M4.91988 12.257C4.2856 12.257 3.65131 12.5199 3.19988 13.0342C2.79417 13.4913 2.59417 14.0799 2.63417 14.6913C2.67417 15.3027 2.94846 15.857 3.4056 16.2627L7.51417 19.8684C7.93131 20.2342 8.46846 20.4399 9.02274 20.4399C9.0856 20.4399 9.14846 20.4399 9.21131 20.4342C9.82846 20.3827 10.4056 20.0799 10.7942 19.5999L20.857 7.27986C21.657 6.30272 21.5085 4.85701 20.5313 4.05701C20.057 3.67415 19.4627 3.49129 18.857 3.55415C18.2513 3.61701 17.7027 3.90844 17.3142 4.38272L8.74846 14.8627L6.42274 12.8227C5.99417 12.4456 5.45131 12.257 4.91988 12.257Z"
                                                          fill="url(#paint0_linear)"/>
                                                    <path d="M9.02279 20.0284C8.56565 20.0284 8.12565 19.8627 7.78279 19.5598L3.67422 15.9541C2.89708 15.2684 2.81708 14.0798 3.50279 13.3027C4.18851 12.5255 5.37708 12.4455 6.15422 13.1313L8.79994 15.4513L17.6285 4.63983C18.2856 3.83412 19.4685 3.71983 20.2742 4.37126C21.0799 5.0284 21.1942 6.21126 20.5428 7.01697L10.4742 19.337C10.1542 19.7313 9.67993 19.977 9.17708 20.0227C9.12565 20.0227 9.07422 20.0284 9.02279 20.0284Z"
                                                          fill="url(#paint1_linear)"/>
                                                    <path opacity="0.75"
                                                          d="M9.02279 20.0284C8.56565 20.0284 8.12565 19.8627 7.78279 19.5598L3.67422 15.9541C2.89708 15.2684 2.81708 14.0798 3.50279 13.3027C4.18851 12.5255 5.37708 12.4455 6.15422 13.1313L8.79994 15.4513L17.6285 4.63983C18.2856 3.83412 19.4685 3.71983 20.2742 4.37126C21.0799 5.0284 21.1942 6.21126 20.5428 7.01697L10.4742 19.337C10.1542 19.7313 9.67993 19.977 9.17708 20.0227C9.12565 20.0227 9.07422 20.0284 9.02279 20.0284Z"
                                                          fill="url(#paint2_radial)"/>
                                                    <path opacity="0.5"
                                                          d="M9.02279 20.0284C8.56565 20.0284 8.12565 19.8627 7.78279 19.5598L3.67422 15.9541C2.89708 15.2684 2.81708 14.0798 3.50279 13.3027C4.18851 12.5255 5.37708 12.4455 6.15422 13.1313L8.79994 15.4513L17.6285 4.63983C18.2856 3.83412 19.4685 3.71983 20.2742 4.37126C21.0799 5.0284 21.1942 6.21126 20.5428 7.01697L10.4742 19.337C10.1542 19.7313 9.67993 19.977 9.17708 20.0227C9.12565 20.0227 9.07422 20.0284 9.02279 20.0284Z"
                                                          fill="url(#paint3_radial)"/>
                                                    <defs>
                                                        <linearGradient id="paint0_linear" x1="15.825" y1="-13.9667"
                                                                        x2="9.82533" y2="23.9171"
                                                                        gradientUnits="userSpaceOnUse">
                                                            <stop stop-color="#00CC00"/>
                                                            <stop offset="0.1878" stop-color="#06C102"/>
                                                            <stop offset="0.5185" stop-color="#17A306"/>
                                                            <stop offset="0.9507" stop-color="#33740C"/>
                                                            <stop offset="1" stop-color="#366E0D"/>
                                                        </linearGradient>
                                                        <linearGradient id="paint1_linear" x1="15.2501" y1="0.625426"
                                                                        x2="7.43443" y2="23.6215"
                                                                        gradientUnits="userSpaceOnUse">
                                                            <stop offset="0.2544" stop-color="#90D856"/>
                                                            <stop offset="0.736" stop-color="#00CC00"/>
                                                            <stop offset="0.7716" stop-color="#0BCD07"/>
                                                            <stop offset="0.8342" stop-color="#29CF18"/>
                                                            <stop offset="0.9166" stop-color="#59D335"/>
                                                            <stop offset="1" stop-color="#90D856"/>
                                                        </linearGradient>
                                                        <radialGradient id="paint2_radial" cx="0" cy="0" r="1"
                                                                        gradientUnits="userSpaceOnUse"
                                                                        gradientTransform="translate(15.452 8.95803) rotate(116.129) scale(8.35776 4.28316)">
                                                            <stop stop-color="#FBE07A" stop-opacity="0.75"/>
                                                            <stop offset="0.0803394" stop-color="#FBE387"
                                                                  stop-opacity="0.6897"/>
                                                            <stop offset="0.5173" stop-color="#FDF2C7"
                                                                  stop-opacity="0.362"/>
                                                            <stop offset="0.8357" stop-color="#FFFBF0"
                                                                  stop-opacity="0.1233"/>
                                                            <stop offset="1" stop-color="white" stop-opacity="0"/>
                                                        </radialGradient>
                                                        <radialGradient id="paint3_radial" cx="0" cy="0" r="1"
                                                                        gradientUnits="userSpaceOnUse"
                                                                        gradientTransform="translate(11.6442 17.0245) rotate(155.316) scale(9.80163 4.14906)">
                                                            <stop stop-color="#440063" stop-opacity="0.25"/>
                                                            <stop offset="1" stop-color="#420061" stop-opacity="0"/>
                                                        </radialGradient>
                                                    </defs>
                                                </svg>
                                            </i>
                                        </div>
                                    </div>


                                    <div class="checkout-address dt-sn px-0 pt-0 pb-0" id="user-address-list-container">
                                        <div class="checkout-address-content">
                                            <div class="checkout-address-headline">آدرس مورد نظر خود را جهت تحویل
                                                انتخاب فرمایید:
                                            </div>
                                            <div class="checkout-address-row">
                                                <div class="checkout-address-col">
                                                    <button class="checkout-address-location" data-bs-toggle="modal"
                                                            data-bs-target="#modal-location">
                                                        <strong>ایجاد آدرس جدید</strong>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <button class="checkout-address-cancel" id="cancel-change-address-btn"></button>
                                    </div>

                                    <!-----------------------------Modal location new -->
                                    <div class="modal fade" id="modal-location" tabindex="-1"
                                         aria-labelledby="exampleModalLabel" aria-hidden="true" role="dialog">
                                        <div class="modal-dialog modal-lg send-info modal-dialog-centered"
                                             role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalCenterTitle">
                                                        <i class="now-ui-icons location_pin"></i>
                                                        افزودن آدرس جدید
                                                    </h5>
                                                    <button type="button" class="close" data-bs-toggle="modal"
                                                            data-bs-target="#modal-location">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <div class="col-lg-12 col-md-12">
                                                            <div class="form-ui dt-sl">
                                                                <form class="form-account" action="" method="post" style="max-width: 100%;">
                                                                    {% csrf_token %}
                                                                    <div class="row">


                                                                        <div class="col-md-6 col-sm-12 mb-2">
                                                                            <div class="form-row-title">
                                                                                <h4>نام</h4>
                                                                            </div>
                                                                            <div class="form-row">
                                                                                <input class="input-ui pr-2 text-right" type="text" name="first_name" placeholder="نام خود را وارد نمایید">
                                                                                {% if form.first_name.errors %}
                                                                                    <div class="alert alert-danger">
                                                                                        {{ form.first_name.errors }}
                                                                                    </div>
                                                                                {% endif %}
                                                                            </div>
                                                                        </div>


                                                                        <div class="col-md-6 col-sm-12 mb-2">
                                                                            <div class="form-row-title">
                                                                                <h4>نام خانوادگی</h4>
                                                                            </div>
                                                                            <div class="form-row">
                                                                                <input class="input-ui pr-2 text-right" type="text" name="last_name" placeholder="نام خود را وارد نمایید">
                                                                                {% if form.last_name.errors %}
                                                                                    <div class="alert alert-danger">
                                                                                        {{ form.last_name.errors }}
                                                                                    </div>
                                                                                {% endif %}
                                                                            </div>
                                                                        </div>


                                                                        <div class="col-md-6 col-sm-12 mb-2">
                                                                            <div class="form-row-title">
                                                                                <h4>شماره موبایل</h4>
                                                                            </div>
                                                                            <div class="form-row">
                                                                                <input class="input-ui pl-2 dir-ltr text-left" type="text" name="phone_number" placeholder="09xxxxxxxxx">
                                                                                {% if form.phone_number.errors %}
                                                                                    <div class="alert alert-danger">
                                                                                        {{ form.phone_number.errors }}
                                                                                    </div>
                                                                                {% endif %}
                                                                            </div>
                                                                        </div>


                                                                        <div class="col-12 mb-2">
                                                                            <div class="form-row-title">
                                                                                <h4>آدرس پستی</h4>
                                                                            </div>
                                                                            <div class="form-row">
                                                                                <textarea class="input-ui pr-2 text-right" name="address" placeholder=" آدرس تحویل گیرنده را وارد نمایید"></textarea>
                                                                                {% if form.address.errors %}
                                                                                    <div class="alert alert-danger">
                                                                                        {{ form.address.errors }}
                                                                                    </div>
                                                                                {% endif %}
                                                                            </div>
                                                                        </div>

                                                                        <div class="col-12 mb-2">
                                                                            <div class="form-row-title">
                                                                                <h4>کد پستی</h4>
                                                                            </div>
                                                                            <div class="form-row">
                                                                                <input class="input-ui pl-2 dir-ltr text-left placeholder-right" type="text" name="postal_code" placeholder=" کد پستی را بدون خط تیره بنویسید">
                                                                                {% if form.postal_code.errors %}
                                                                                    <div class="alert alert-danger">
                                                                                        {{ form.postal_code.errors }}
                                                                                    </div>
                                                                                {% endif %}
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-12 pr-4 pl-4">
                                                                            <button type="submit" class="btn btn-sm btn-primary btn-submit-form" style="background: #f7858d;font-weight: 600;box-shadow: none;border: none;margin-top: 10px;color: #fff;">
                                                                                ثبت
                                                                                و
                                                                                ارسال به این آدرس
                                                                            </button>
                                                                            {#                                                                            <button type="button"#}
                                                                            {#                                                                                    class="btn-link-border float-left mt-3">#}
                                                                            {#                                                                                انصراف#}
                                                                            {#                                                                                و بازگشت#}
                                                                            {#                                                                            </button>#}
                                                                        </div>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-----------------------------Modal location new -->
                                </div>
                            </div>

                            <form method="post" id="shipping-data-form" class="dt-sn dt-sn--box pt-3 pb-3">
                                <div class="section-title text-sm-title title-wide no-after-title-wide mb-0 px-res-1">
                                    <h2>روش پرداخت</h2>
                                </div>
                                <div class="checkout-shipment border-bottom pb-3 mb-4">
                                    <div class="custom-control custom-radio pl-0 pr-3">
                                        <input type="radio" class="custom-control-input" name="radio1" id="radio1"
                                               value="option1" checked>
                                        <label for="radio1" class="custom-control-label">
                                            درگاه پرداخت زرین پال
                                        </label>
                                    </div>
                                </div>
                                <div class="section-title text-sm-title title-wide no-after-title-wide mb-0 px-res-1">
                                    <h2>مرسوله </h2>
                                </div>
                                <div class="checkout-pack">
                                    <section class="products-compact">
                                        <!-- Start Product-Slider -->
                                        <div class="col-12">
                                            <div class="products-compact-slider carousel-md owl-carousel owl-theme">
                                                {% for item in cart %}
                                                    <div class="item">
                                                        <div class="product-card mb-3">
                                                            <a class="product-thumb" href="{% url 'product_detail' item.product_obj.id %}">
                                                                <img src="{{ item.product_obj.image.url }}"
                                                                     alt="Product Thumbnail">
                                                            </a>
                                                            <div class="product-card-body">
                                                                <h5 class="product-title">
                                                                    <a href="{% url 'product_detail' item.product_obj.id %}">{{ item.product_obj.title }}</a>
                                                                </h5>
                                                                <span class="product-card">تعداد : {{ item.quantity  }}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        </div>
                                        <!-- End Product-Slider -->
                                    </section>
                                </div>
                            </form>


                            <div class="mt-5">
                                <a href="{% url 'cart_detail' %}" class="float-right border-bottom-dt"><i class="mdi mdi-chevron-double-right"></i>بازگشت به سبد خرید</a>

                            </div>
                        </section>
                    </div>
                    <div class="col-xl-3 col-lg-4 col-12 sticky-sidebar">
                        <div class="widget-post1 dt-sn dt-sn--box border mb-2">
                            <ul class="checkout-summary-summary">
                                <li>
                                    <span>مبلغ کل ({{ cart|length }} کالا)</span><span>{{ cart.get_total_price|intcomma:False }} تومان</span>
                                </li>
                                <li>
                                    <span>هزینه ارسال<span class="help-sn" data-toggle="tooltip" data-html="true"
                                                           data-placement="bottom"
                                                           title="<div class='help-container is-right'><div class='help-arrow'></div><p class='help-text'>هزینه ارسال مرسولات می‌تواند وابسته به شهر و آدرس گیرنده متفاوت باشد. در صورتی که هر یک از مرسولات حداقل ارزشی برابر با ۱۵۰هزار تومان داشته باشد، آن مرسوله بصورت رایگان ارسال می‌شود.<br>'حداقل ارزش هر مرسوله برای ارسال رایگان، می تواند متغیر باشد.'</p></div>">
                                            <span class="mdi mdi-information-outline"></span>
                                        </span></span><span>وابسته به آدرس</span>
                                </li>
                            </ul>
                            <div class="checkout-summary-devider">
                                <div></div>
                            </div>
                            <div class="checkout-summary-content">
                                <div class="checkout-summary-price-title">مبلغ قابل پرداخت:</div>
                                <div class="checkout-summary-price-value">
                                    <span class="checkout-summary-price-value-amount">{{ cart.get_total_price|intcomma:False }}</span>
                                    تومان
                                </div>
                                <a href="#" class="mb-2 d-block">
                                    <button class="btn-primary-cm btn-with-icon w-100 text-center pr-0 pl-0">
                                        <i>
                                            <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none"
                                                 xmlns="http://www.w3.org/2000/svg">
                                                <g id="Iconly/Curved/Arrow - Left">
                                                    <g id="Arrow - Left">
                                                        <path id="Stroke 1" d="M4.24988 12.2742L19.2499 12.2742"
                                                              stroke="#fff" stroke-width="1.5" stroke-linecap="round"
                                                              stroke-linejoin="round"></path>
                                                        <path id="Stroke 3"
                                                              d="M10.3002 18.2988C10.3002 18.2988 4.25017 15.0378 4.25017 12.2758C4.25017 9.51176 10.3002 6.24976 10.3002 6.24976"
                                                              stroke="#fff" stroke-width="1.5" stroke-linecap="round"
                                                              stroke-linejoin="round"></path>
                                                    </g>
                                                </g>
                                            </svg>
                                        </i>
                                        پرداخت
                                    </button>
                                </a>
                                <div>
                                    <span>
                                        کالاهای موجود در سبد شما ثبت و رزرو نشده‌اند، برای ثبت سفارش
                                        مراحل بعدی را تکمیل کنید.
                                    </span><span class="help-sn" data-toggle="tooltip" data-html="true"
                                                 data-placement="bottom"
                                                 title="<div class='help-container is-right'><div class='help-arrow'></div><p class='help-text'>محصولات موجود در سبد خرید شما تنها در صورت ثبت و پرداخت سفارش برای شما رزرو می‌شوند. در صورت عدم ثبت سفارش، دیجی پرس هیچگونه مسئولیتی در قبال تغییر قیمت یا موجودی این کالاها ندارد.</p></div>">
                                        <span class="mdi mdi-information-outline"></span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="widget-post2 dt-sn dt-sn--box checkout-feature-aside pt-4">
                            <ul>
                                <li class="checkout-feature-aside-item">
                                    <img src="./assets/img/svg/return-policy.svg" alt="">
                                    هفت روز ضمانت تعویض
                                </li>
                                <li class="checkout-feature-aside-item">
                                    <img src="./assets/img/svg/payment-terms.svg" alt="">
                                    پرداخت در محل با کارت بانکی
                                </li>
                                <li class="checkout-feature-aside-item">
                                    <img src="./assets/img/svg/delivery.svg" alt="">
                                    تحویل اکسپرس
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <!--------------------------- Main Content Section-->

    </div>
{% endblock %}